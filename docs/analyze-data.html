<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Analyze data | Salinity and Germination for 3 native species and invasive Phragmites australis</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Analyze data | Salinity and Germination for 3 native species and invasive Phragmites australis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Analyze data | Salinity and Germination for 3 native species and invasive Phragmites australis" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Maddie Houde" />


<meta name="date" content="2023-04-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="creating-visuals-with-our-dataset.html"/>
<link rel="next" href="drawing-further-inference.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Reproducible Data Science Final Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1" data-path="database-structure.html"><a href="database-structure.html"><i class="fa fa-check"></i><b>1</b> Database Structure</a>
<ul>
<li class="chapter" data-level="1.1" data-path="database-structure.html"><a href="database-structure.html#describing-the-relational-structures-in-sandra-johnstons-2023-greenhouse-experiment."><i class="fa fa-check"></i><b>1.1</b> Describing the relational structures in Sandra Johnstonâ€™s 2023 Greenhouse Experiment.</a></li>
<li class="chapter" data-level="1.2" data-path="database-structure.html"><a href="database-structure.html#build-database-tables"><i class="fa fa-check"></i><b>1.2</b> Build database tables</a></li>
<li class="chapter" data-level="1.3" data-path="database-structure.html"><a href="database-structure.html#read-our-csv-files-and-connect-them"><i class="fa fa-check"></i><b>1.3</b> Read our CSV files and connect them</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>2</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#load-required-r-packages-and-raw-data"><i class="fa fa-check"></i><b>2.1</b> Load required R packages and raw data</a></li>
<li class="chapter" data-level="2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#changing-column-class"><i class="fa fa-check"></i><b>2.2</b> Changing column class</a></li>
<li class="chapter" data-level="2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#explore-the-data-frame"><i class="fa fa-check"></i><b>2.3</b> Explore the data frame</a></li>
<li class="chapter" data-level="2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#adding-a-column"><i class="fa fa-check"></i><b>2.4</b> Adding a column</a></li>
<li class="chapter" data-level="2.5" data-path="data-wrangling.html"><a href="data-wrangling.html#removing-filtering-data"><i class="fa fa-check"></i><b>2.5</b> Removing (filtering) data</a></li>
<li class="chapter" data-level="2.6" data-path="data-wrangling.html"><a href="data-wrangling.html#changing-incorrect-data"><i class="fa fa-check"></i><b>2.6</b> Changing incorrect data</a></li>
<li class="chapter" data-level="2.7" data-path="data-wrangling.html"><a href="data-wrangling.html#save-your-data-object-for-future-use"><i class="fa fa-check"></i><b>2.7</b> Save your data object for future use</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="creating-visuals-with-our-dataset.html"><a href="creating-visuals-with-our-dataset.html"><i class="fa fa-check"></i><b>3</b> Creating Visuals with our dataset</a>
<ul>
<li class="chapter" data-level="3.1" data-path="creating-visuals-with-our-dataset.html"><a href="creating-visuals-with-our-dataset.html#load-our-previously-cleaned-dataset"><i class="fa fa-check"></i><b>3.1</b> Load our previously cleaned dataset</a></li>
<li class="chapter" data-level="3.2" data-path="creating-visuals-with-our-dataset.html"><a href="creating-visuals-with-our-dataset.html#prepare-dataset-to-create-a-graph-showing-cumulative-germination-counts"><i class="fa fa-check"></i><b>3.2</b> Prepare dataset to create a graph showing cumulative germination counts</a></li>
<li class="chapter" data-level="3.3" data-path="creating-visuals-with-our-dataset.html"><a href="creating-visuals-with-our-dataset.html#cumulative-germination-graph"><i class="fa fa-check"></i><b>3.3</b> Cumulative Germination Graph</a></li>
<li class="chapter" data-level="3.4" data-path="creating-visuals-with-our-dataset.html"><a href="creating-visuals-with-our-dataset.html#cumulative-germination-graph-1"><i class="fa fa-check"></i><b>3.4</b> Cumulative Germination Graph</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analyze-data.html"><a href="analyze-data.html"><i class="fa fa-check"></i><b>4</b> Analyze data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="analyze-data.html"><a href="analyze-data.html#load-data."><i class="fa fa-check"></i><b>4.1</b> Load data.</a></li>
<li class="chapter" data-level="4.2" data-path="analyze-data.html"><a href="analyze-data.html#remove-40-ppt"><i class="fa fa-check"></i><b>4.2</b> Remove 40 PPT</a></li>
<li class="chapter" data-level="4.3" data-path="analyze-data.html"><a href="analyze-data.html#poisson-model"><i class="fa fa-check"></i><b>4.3</b> Poisson model</a></li>
<li class="chapter" data-level="4.4" data-path="analyze-data.html"><a href="analyze-data.html#poisson-model-diagnostic-plots"><i class="fa fa-check"></i><b>4.4</b> Poisson model diagnostic plots</a></li>
<li class="chapter" data-level="4.5" data-path="analyze-data.html"><a href="analyze-data.html#negative-binomial-model"><i class="fa fa-check"></i><b>4.5</b> Negative binomial model</a></li>
<li class="chapter" data-level="4.6" data-path="analyze-data.html"><a href="analyze-data.html#fixed-effects-prior"><i class="fa fa-check"></i><b>4.6</b> Fixed effects prior</a></li>
<li class="chapter" data-level="4.7" data-path="analyze-data.html"><a href="analyze-data.html#weaker-fixed-effects-priors"><i class="fa fa-check"></i><b>4.7</b> Weaker fixed effects priors</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="drawing-further-inference.html"><a href="drawing-further-inference.html"><i class="fa fa-check"></i><b>5</b> Drawing further inference</a>
<ul>
<li class="chapter" data-level="5.1" data-path="drawing-further-inference.html"><a href="drawing-further-inference.html#pairwise-comparison"><i class="fa fa-check"></i><b>5.1</b> Pairwise comparison</a></li>
<li class="chapter" data-level="5.2" data-path="drawing-further-inference.html"><a href="drawing-further-inference.html#conclusions"><i class="fa fa-check"></i><b>5.2</b> Conclusions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Salinity and Germination for 3 native species and invasive Phragmites australis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analyze-data" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Analyze data<a href="analyze-data.html#analyze-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Weâ€™ve now seen what our raw data looks like, and we have an idea that salinity
had a significant effect on species germination. However, we would like to show
that effect using a generalized linear mixed model.</p>
<div id="load-data." class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Load data.<a href="analyze-data.html#load-data." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Load packages too.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="analyze-data.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#gives ggplot2 and piping</span></span>
<span id="cb101-2"><a href="analyze-data.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span></code></pre></div>
<pre><code>## Warning: package &#39;glmmTMB&#39; was built under R version 4.1.3</code></pre>
<pre><code>## Warning in checkMatrixPackageVersion(): Package version inconsistency detected.
## TMB was built with Matrix version 1.5.1
## Current Matrix version is 1.5.3
## Please re-install &#39;TMB&#39; from source using install.packages(&#39;TMB&#39;, type = &#39;source&#39;) or ask CRAN for a binary version of &#39;TMB&#39; matching CRAN&#39;s &#39;Matrix&#39; package</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="analyze-data.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code></pre></div>
<pre><code>## Warning: package &#39;car&#39; was built under R version 4.1.3</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     some</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="analyze-data.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span></code></pre></div>
<pre><code>## Warning: package &#39;DHARMa&#39; was built under R version 4.1.3</code></pre>
<pre><code>## This is DHARMa 0.4.6. For overview type &#39;?DHARMa&#39;. For recent changes, type news(package = &#39;DHARMa&#39;)</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="analyze-data.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span></code></pre></div>
<pre><code>## Warning: package &#39;emmeans&#39; was built under R version 4.1.3</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="analyze-data.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(blme)</span></code></pre></div>
<pre><code>## Warning: package &#39;blme&#39; was built under R version 4.1.3</code></pre>
<pre><code>## Loading required package: lme4</code></pre>
<pre><code>## Warning: package &#39;lme4&#39; was built under R version 4.1.3</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Warning: package &#39;Matrix&#39; was built under R version 4.1.3</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, pack, unpack</code></pre>
<p>We will analyze our data using total germination counts, and will likely use a
Poisson distribution. To do that, we need to create a new column for total counts.
We also want to add a new column which accounts for the location (or block) in the
greenhouse. We will call this spot the â€˜Whole_Plotâ€™</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="analyze-data.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Whole Plot</span></span>
<span id="cb123-2"><a href="analyze-data.html#cb123-2" aria-hidden="true" tabindex="-1"></a>Germ<span class="sc">$</span>Whole_Plot <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">paste</span>(Germ<span class="sc">$</span>Column, Germ<span class="sc">$</span>Row))</span>
<span id="cb123-3"><a href="analyze-data.html#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="analyze-data.html#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total Emergence</span></span>
<span id="cb123-5"><a href="analyze-data.html#cb123-5" aria-hidden="true" tabindex="-1"></a>Germ <span class="ot">&lt;-</span> Germ <span class="sc">%&gt;%</span></span>
<span id="cb123-6"><a href="analyze-data.html#cb123-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Species, Salinity, Whole_Plot) <span class="sc">%&gt;%</span></span>
<span id="cb123-7"><a href="analyze-data.html#cb123-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Total_Emergence =</span> <span class="fu">sum</span>(Emergence)) <span class="sc">%&gt;%</span></span>
<span id="cb123-8"><a href="analyze-data.html#cb123-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Species&#39;, &#39;Salinity&#39;. You can override
## using the `.groups` argument.</code></pre>
</div>
<div id="remove-40-ppt" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Remove 40 PPT<a href="analyze-data.html#remove-40-ppt" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you recall, the 40 PPT had zero germination counts. We recognize that this is
a species tolerance limit for ALL of our species in this experiment. We wonâ€™t gain
any new information by including this in our analysis, so we remove it here.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="analyze-data.html#cb125-1" aria-hidden="true" tabindex="-1"></a>Germ <span class="ot">&lt;-</span> Germ <span class="sc">%&gt;%</span></span>
<span id="cb125-2"><a href="analyze-data.html#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Salinity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Fresh&quot;</span>, <span class="st">&quot;25&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb125-3"><a href="analyze-data.html#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Salinity =</span> <span class="fu">factor</span>(Salinity, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Fresh&quot;</span>, <span class="st">&quot;25&quot;</span>)))</span></code></pre></div>
<p>We can check that we successfully removed 40 as a salinity factor.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="analyze-data.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Germ<span class="sc">$</span>Salinity)</span></code></pre></div>
<pre><code>## [1] &quot;Fresh&quot; &quot;25&quot;</code></pre>
</div>
<div id="poisson-model" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Poisson model<a href="analyze-data.html#poisson-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first stab at model creation.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="analyze-data.html#cb128-1" aria-hidden="true" tabindex="-1"></a>G_Mod <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Total_Emergence <span class="sc">~</span> Species <span class="sc">+</span> Salinity <span class="sc">+</span> Species<span class="sc">:</span>Salinity</span>
<span id="cb128-2"><a href="analyze-data.html#cb128-2" aria-hidden="true" tabindex="-1"></a>            <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">|</span> Whole_Plot), </span>
<span id="cb128-3"><a href="analyze-data.html#cb128-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> poisson, <span class="co"># count data</span></span>
<span id="cb128-4"><a href="analyze-data.html#cb128-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> Germ)</span></code></pre></div>
</div>
<div id="poisson-model-diagnostic-plots" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Poisson model diagnostic plots<a href="analyze-data.html#poisson-model-diagnostic-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Letâ€™s see how this model fits by looking at residual plots and DHARMa diagnostics.
<img src="_main_files/figure-html/DHARMa%20diagnostics%20basic-1.png" width="672" /><img src="_main_files/figure-html/DHARMa%20diagnostics%20basic-2.png" width="672" /></p>
<p>Our model fit could be improved. The second plot shows us that our mean very likely
does not equal our variance (as is assumed by a Poisson distribution). To address this,
we can swap to a negative binomial distribution and see if the diagnostics improve.</p>
</div>
<div id="negative-binomial-model" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Negative binomial model<a href="analyze-data.html#negative-binomial-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="analyze-data.html#cb129-1" aria-hidden="true" tabindex="-1"></a>G_Mod <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Total_Emergence <span class="sc">~</span> Species <span class="sc">+</span> Salinity <span class="sc">+</span> Species<span class="sc">:</span>Salinity</span>
<span id="cb129-2"><a href="analyze-data.html#cb129-2" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">|</span> Whole_Plot),</span>
<span id="cb129-3"><a href="analyze-data.html#cb129-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">nbinom1</span>(), <span class="co"># quasi poisson</span></span>
<span id="cb129-4"><a href="analyze-data.html#cb129-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> Germ)</span></code></pre></div>
<p>Note that our model statement is exactly the same, with the exception of the
family call. Letâ€™s look at those diagnostic plots.</p>
<p><img src="_main_files/figure-html/diagnostic%20plots%20nbinom-1.png" width="672" /></p>
<p>This looks better! Now I will explore the model further.</p>
<p><img src="_main_files/figure-html/explore%20nbinom%20model-1.png" width="672" /></p>
<p>The spread of residuals is improved here. We can also look at the salinity effect
on our model estimates.</p>
<p><img src="_main_files/figure-html/other%20nbinom-1.png" width="672" />
The Salicornia rubra here has a highly negative prediction from Fresh to 25.
This poses an issue when interpreting our data. It likely resulted from having
zero germination at the 25 PPT salinity for SARU (as seen below).</p>
<pre><code>## # A tibble: 4 x 4
##   Species Salinity Whole_Plot Total_Emergence
##   &lt;fct&gt;   &lt;fct&gt;    &lt;fct&gt;                &lt;dbl&gt;
## 1 SARU    25       1 3                      0
## 2 SARU    25       2 1                      0
## 3 SARU    25       3 2                      0
## 4 SARU    25       3 4                      0</code></pre>
<p>We had 4 replicates, and you can see that each replicate had zero seeds emerge.
Poisson and negative binomial distributions struggle with zero counts, because it
has (1) no variance and (2) it exists right at the edge of the distributions range
(0, infinity). We need to address this by adding a fixed effects prior to our
model. Our model interpretation is meaningless as is, because the 0â€™s can impact
other model estimates.</p>
</div>
<div id="fixed-effects-prior" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Fixed effects prior<a href="analyze-data.html#fixed-effects-prior" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Below we switch to using bglmer() rather than glmmTMB() because it allows us to add
fixed effects priors. These are added to our model estimates, in the order of our
model summary. To remind ourselves how many fixed effects we have, we can look at our
summary.</p>
<pre><code>##  Family: nbinom1  ( log )
## Formula:          
## Total_Emergence ~ Species + Salinity + Species:Salinity + (1 |      Whole_Plot)
## Data: Germ
## 
##      AIC      BIC   logLik deviance df.resid 
##    136.7    146.1    -60.4    120.7       16 
## 
## Random effects:
## 
## Conditional model:
##  Groups     Name        Variance  Std.Dev. 
##  Whole_Plot (Intercept) 5.517e-16 2.349e-08
## Number of obs: 24, groups:  Whole_Plot, 8
## 
## Dispersion parameter for nbinom1 family (): 2.59 
## 
## Conditional model:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)             4.238e+00  1.132e-01   37.44  &lt; 2e-16 ***
## SpeciesPHAU            -5.829e-03  1.598e-01   -0.04  0.97090    
## SpeciesSARU            -2.559e+00  3.988e-01   -6.42 1.39e-10 ***
## Salinity25             -1.791e+00  3.027e-01   -5.92 3.26e-09 ***
## SpeciesPHAU:Salinity25 -3.121e+00  1.076e+00   -2.90  0.00374 ** 
## SpeciesSARU:Salinity25 -1.933e+01  1.183e+04    0.00  0.99870    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>There are 6 fixed effects to account for. Also note that the estimate for SARU
and its interaction with 25 PPT has a really large standard error (1.183e04).
That number should change if we successfully adjust away from 0.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="analyze-data.html#cb132-1" aria-hidden="true" tabindex="-1"></a>G_Mod <span class="ot">&lt;-</span> <span class="fu">bglmer</span>(Total_Emergence <span class="sc">~</span> Species <span class="sc">*</span> Salinity</span>
<span id="cb132-2"><a href="analyze-data.html#cb132-2" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">|</span> Whole_Plot),</span>
<span id="cb132-3"><a href="analyze-data.html#cb132-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="co"># back to Poisson for now</span></span>
<span id="cb132-4"><a href="analyze-data.html#cb132-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fixef.prior =</span> <span class="fu">normal</span>(<span class="at">sd =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)), </span>
<span id="cb132-5"><a href="analyze-data.html#cb132-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> Germ)</span></code></pre></div>
<p>Priors of 3 represent a reasonable value (2.5 is default). The larger number
you have the less of an effect it makes on your data.</p>
<p>Letâ€™s see if the standard error was adjusted.</p>
<pre><code>## Cov prior  : Whole_Plot ~ wishart(df = 3.5, scale = Inf, posterior.scale = cov, common.scale = TRUE)
## Fixef prior: normal(sd = c(3, 3, ...), corr = c(0 ...), common.scale = FALSE)
## Prior dev  : 30.6443
## 
## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [bglmerMod]
##  Family: poisson  ( log )
## Formula: Total_Emergence ~ Species * Salinity + (1 | Whole_Plot)
##    Data: Germ
## 
##      AIC      BIC   logLik deviance df.resid 
##    138.8    147.0    -62.4    124.8       17 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.8141 -0.4300 -0.2502  0.4163  1.7269 
## 
## Random effects:
##  Groups     Name        Variance Std.Dev.
##  Whole_Plot (Intercept) 0.4629   0.6804  
## Number of obs: 24, groups:  Whole_Plot, 8
## 
## Fixed effects:
##                        Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)             4.13865    0.34669  11.938  &lt; 2e-16 ***
## SpeciesPHAU            -0.01159    0.08563  -0.135 0.892305    
## SpeciesSARU            -2.61655    0.23045 -11.354  &lt; 2e-16 ***
## Salinity25             -1.78677    0.50523  -3.537 0.000405 ***
## SpeciesPHAU:Salinity25 -3.66333    0.82479  -4.442 8.93e-06 ***
## SpeciesSARU:Salinity25 -2.63018    1.58631  -1.658 0.097306 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) SpPHAU SpSARU Slnt25 SPHAU:
## SpeciesPHAU -0.120                            
## SpeciesSARU -0.044  0.183                     
## Salinity25  -0.645  0.080  0.029              
## SpcPHAU:S25  0.011 -0.096 -0.017 -0.047       
## SpcSARU:S25  0.004 -0.019 -0.105 -0.019  0.011</code></pre>
<p>Now the standard error is 1.58, which is a lot more reasonable! However, we may
not wish to penalize all of our fixed effects if SARU poses the only issue. In
this case, we could use large numbers on effects where we want weak penalization,
and use smaller numbers (e.g., 2.5) for our problem child. One more note that PHAU
(Phragmites australis) also had low germination at 25 PPT. To account for this,
I will penalize PHAU:25 as well.</p>
</div>
<div id="weaker-fixed-effects-priors" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Weaker fixed effects priors<a href="analyze-data.html#weaker-fixed-effects-priors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="analyze-data.html#cb134-1" aria-hidden="true" tabindex="-1"></a>G_Mod <span class="ot">&lt;-</span> <span class="fu">bglmer</span>(Total_Emergence <span class="sc">~</span> Species <span class="sc">*</span> Salinity</span>
<span id="cb134-2"><a href="analyze-data.html#cb134-2" aria-hidden="true" tabindex="-1"></a>                 <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">|</span> Whole_Plot),</span>
<span id="cb134-3"><a href="analyze-data.html#cb134-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">poisson</span>(),</span>
<span id="cb134-4"><a href="analyze-data.html#cb134-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fixef.prior =</span> <span class="fu">normal</span>(<span class="fu">c</span>(<span class="fl">1e4</span>, <span class="fl">1e4</span>, <span class="fl">1e4</span>, <span class="fl">1e4</span>, <span class="fl">2.5</span>, <span class="fl">2.5</span>)), </span>
<span id="cb134-5"><a href="analyze-data.html#cb134-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> Germ)</span>
<span id="cb134-6"><a href="analyze-data.html#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(G_Mod)</span></code></pre></div>
<pre><code>## Cov prior  : Whole_Plot ~ wishart(df = 3.5, scale = Inf, posterior.scale = cov, common.scale = TRUE)
## Fixef prior: normal(sd = c(10000, 10000, ...), corr = c(0 ...), common.scale = FALSE)
## Prior dev  : 92.4226
## 
## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [bglmerMod]
##  Family: poisson  ( log )
## Formula: Total_Emergence ~ Species * Salinity + (1 | Whole_Plot)
##    Data: Germ
## 
##      AIC      BIC   logLik deviance df.resid 
##    139.0    147.3    -62.5    125.0       17 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.7887 -0.4347 -0.2716  0.4346  1.5901 
## 
## Random effects:
##  Groups     Name        Variance Std.Dev.
##  Whole_Plot (Intercept) 0.4624   0.68    
## Number of obs: 24, groups:  Whole_Plot, 8
## 
## Fixed effects:
##                        Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)             4.21924    0.34534  12.218  &lt; 2e-16 ***
## SpeciesPHAU            -0.01653    0.08559  -0.193 0.846813    
## SpeciesSARU            -2.63979    0.23294 -11.333  &lt; 2e-16 ***
## Salinity25             -1.90030    0.52414  -3.626 0.000288 ***
## SpeciesPHAU:Salinity25 -3.54285    0.77452  -4.574 4.78e-06 ***
## SpeciesSARU:Salinity25 -2.34789    1.37923  -1.702 0.088696 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) SpPHAU SpSARU Slnt25 SPHAU:
## SpeciesPHAU -0.123                            
## SpeciesSARU -0.045  0.181                     
## Salinity25  -0.659  0.080  0.029              
## SpcPHAU:S25  0.012 -0.100 -0.018 -0.048       
## SpcSARU:S25  0.005 -0.021 -0.118 -0.021  0.013</code></pre>
<p>We can explore this model to assess model fit.</p>
<pre><code>## Warning in checkModel(fittedModel): DHARMa: fittedModel not in class of
## supported models. Absolutely no guarantee that this will work!</code></pre>
<p><img src="_main_files/figure-html/explore%20model-1.png" width="672" /><img src="_main_files/figure-html/explore%20model-2.png" width="672" />
This model fit could be improved. Earlier, we fixed these issues by moving to a
nbinom() distribution. Unfortunately, that is not possible when using fixed effects
priors.</p>
<p>However, letâ€™s take a step back and look at the raw data.</p>
<pre><code>## `summarise()` has grouped output by &#39;Species&#39;, &#39;Salinity&#39;. You can override
## using the `.groups` argument.</code></pre>
<p><img src="_main_files/figure-html/graphs%20again-1.png" width="672" /></p>
<p>It is pretty clear from the above graph that salinity DID have an effect on species
germination, and perhaps that we would expect differing magnitudes of reduction
between species as we move from fresh to 25 ppt salinity.</p>
<p>We shouldnâ€™t have to go to crazy efforts to prove what we already know by looking
at our raw data. Not to mention - there is danger in applying complicated statistics
when you cannot easily explain their purpose.</p>
<p>With that said, we will go forward with the use of this model.</p>
<p>Letâ€™s explore salinity effect with model estimates.
<img src="_main_files/figure-html/sal%20effect-1.png" width="672" />
These error bars are a lot more reasonable!</p>
<p>Other exploration graphsâ€¦</p>
<p><img src="_main_files/figure-html/explore%20mod%20graphs-1.png" width="672" /><img src="_main_files/figure-html/explore%20mod%20graphs-2.png" width="672" /></p>
<p>Check for significance of fixed effects</p>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: Total_Emergence
##                    Chisq Df Pr(&gt;Chisq)    
## Species          138.712  2  &lt; 2.2e-16 ***
## Salinity          15.099  1   0.000102 ***
## Species:Salinity  23.627  2  7.405e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Yup, as expected: the interaction between species and salinity is significant.
We can use emmeans to view real-world (back transformed) model estimates of species
germination at each salinity level.</p>
<pre><code>## Species = ALOC:
##  Salinity    rate      SE  df asymp.LCL asymp.UCL
##  Fresh    67.9817 23.4766 Inf   34.5494    133.77
##  25       10.1649  4.0090 Inf    4.6923     22.02
## 
## Species = PHAU:
##  Salinity    rate      SE  df asymp.LCL asymp.UCL
##  Fresh    66.8669 23.0976 Inf   33.9769    131.59
##  25        0.2893  0.2449 Inf    0.0550      1.52
## 
## Species = SARU:
##  Salinity    rate      SE  df asymp.LCL asymp.UCL
##  Fresh     4.8523  1.9787 Inf    2.1819     10.79
##  25        0.0693  0.0983 Inf    0.0043      1.12
## 
## Confidence level used: 0.95 
## Intervals are back-transformed from the log scale</code></pre>
<p>Whew! We did a lot of work here. Now that we know our interaction is significant,
we can try to tease out which combination of effects are significant. However, that
will have to wait for another chapter. See you soon!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="creating-visuals-with-our-dataset.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="drawing-further-inference.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/4_Analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
